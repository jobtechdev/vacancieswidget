(function(){var emailEncoder=this.emailEncoder=function(applicationBasePath,addTitleOnMailtoLinks,alwaysOpenNewWindow){this.applicationBasePath=applicationBasePath;this.addTitleOnMailtoLinks=addTitleOnMailtoLinks;this.alwaysOpenNewWindow=alwaysOpenNewWindow;this.init();return this};emailEncoder.fn=emailEncoder.prototype={init:function(){var ee=this;if(document.addEventListener){document.addEventListener("DOMContentLoaded",function(){document.removeEventListener("DOMContentLoaded",arguments.callee,false);ee.scanDocument()},false)}else{if(document.attachEvent){document.attachEvent("onreadystatechange",function(){if(document.readyState==="complete"){document.detachEvent("onreadystatechange",arguments.callee);ee.scanDocument()}})}else{var ol=window.onload;if(typeof window.onload!="function"){ol=false}window.onload=function(){ee.scanDocument();if(ol){ol()}}}}},scanDocument:function(){var ls=document.getElementsByTagName("a");for(var i=0;i<ls.length;i++){var t=this.parseLink(ls[i].href);if(t==null){continue}if(navigator.userAgent.indexOf("MSIE")>0){var temp=ls[i].innerHTML;ls[i].href=t;ls[i].innerHTML=temp}else{ls[i].setAttribute("href",t)}if(this.addTitleOnMailtoLinks){ls[i].setAttribute("title",t.replace(/^mailto:/,"").replace(/%20/g," "))}}var ls=document.getElementsByTagName("area");for(var i=0;i<ls.length;i++){var t=this.parseLink(ls[i].href);if(t==null){continue}ls[i].setAttribute("href",t);if(this.addTitleOnMailtoLinks){ls[i].setAttribute("title",t.replace(/^mailto:/,"").replace(/%20/g," "))}}var is=document.getElementsByTagName("img");for(var i=is.length-1;i>=0;i--){var t=this.parseLink(is[i].src);if(t==null){continue}is[i].parentNode.replaceChild(document.createTextNode(t),is[i])}var is=document.getElementsByTagName("span");for(var i=is.length-1;i>=0;i--){var eu=is[i].getAttribute("title");if(eu==null){continue}var t=this.parseLink(eu);if(t==null){continue}is[i].parentNode.replaceChild(document.createTextNode(t),is[i])}},splitParameters:function(p){var r=new Object();p=p.replace(/&amp;/g,"&");pairs=p.split(/&/);for(var i=0;i<pairs.length;i++){var a=pairs[i].split(/=/);if(a.length==2){r[a[0]]=a[1]}}return r},decode:function(h){return null},parseLink:function(h){var s=h.indexOf("EmailEncoderEmbed.aspx?");if(s<0){return null}h=h.substr(s+23);h=this.splitParameters(h);if(h.replace=="false"){return null}var t=this.decode(h);return t}}})();